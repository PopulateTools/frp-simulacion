function getName(){getActive(event.target.getAttribute("name"))}function getActive(e){const t=document.querySelectorAll(`input[name='${e}']`);for(let e=0;e<t.length;e++){const a=t[e].parentNode;!1===t[e].checked?a.classList.remove("active-checkbox"):a.classList.add("active-checkbox")}}function tooltips(e,t){new Tooltip(document.getElementById(e),{placement:"top",title:t})}document.querySelectorAll(".input-radio").forEach((e=>e.addEventListener("click",(()=>{getName(),checkValues()})))),document.getElementById("button-view").addEventListener("click",(()=>{document.getElementById("initial-view").style.opacity="0",setTimeout((()=>{document.getElementById("initial-view").style.display="none",document.getElementById("text-back").style.display="none",document.getElementById("simulation-view").style.display="block",document.getElementById("back-view").style.display="block",multipleLine(),multipLeFired=!0}),300),document.getElementById("simulation-view").style.opacity="1",document.getElementById("back-view").style.opacity="1",document.getElementById("empleo-view").classList.remove("btn-view-active"),document.getElementById("pib-view").classList.add("btn-view-active"),simulationView=!0})),document.getElementById("back-view").addEventListener("click",(()=>{document.getElementById("initial-view").style.opacity="1",setTimeout((()=>{document.getElementById("initial-view").style.display="block",document.getElementById("text-back").style.display="block",document.getElementById("simulation-view").style.display="none",document.getElementById("back-view").style.display="none"}),300),document.getElementById("simulation-view").style.opacity="0",document.getElementById("back-view").style.opacity="0",document.querySelectorAll(".input-radio").checked=!1,simulationView=!1})),document.getElementById("empleo-view").addEventListener("click",(()=>{document.getElementById("pib-view").classList.remove("btn-view-active"),document.getElementById("empleo-view").classList.add("btn-view-active"),valueFilter="empleo"})),document.getElementById("pib-view").addEventListener("click",(()=>{document.getElementById("empleo-view").classList.remove("btn-view-active"),document.getElementById("pib-view").classList.add("btn-view-active"),valueFilter="pib"}));const tooltipInfo=[["tooltip-pf","Elija el instrumento fiscal para estimular la economía"],["tooltip-idc","Elija el instrumento fiscal que utilizaría el gobierno para ajustar la ratio de deuda sobre PIB a su nivel inicial."],["tooltip-vdc","Elija el tiempo que el gobierno tardará en activar el instrumento de consolidación: (1) Rápida (el gobierno empieza a subir impuestos o reducir gasto transcurrido un año desde el estímulo fiscal); (2) Lenta (el gobierno empieza a subir impuestos o reducir gasto transcurridos cuatro años desde el estímulo fiscal)."],["tooltip-empleo-diferencia","La barra verde oscura representa la diferencia, año a año, entre el nivel de PIB/Empleo simulado con la política y el nivel de PIB/Empleo previsto en el Programa de Estabilidad. La barra verde clara representa la diferencia acumulada hasta un año entre el PIB/Empleo simulado con la política y el PIB/Empleo previsto en el Programa de Estabilidad."],["tooltip-pib-diferencia","La barra verde oscura representa la diferencia, año a año, entre el nivel del PIB o el Empleo simulado con la política y el nivel del PIB o el Empleo previsto en el Programa de Estabilidad. La barra verde clara representa la diferencia acumulada hasta un año concreto entre el PIB o el Empleo simulado con la política fiscal y el PIB o el Empleo previsto en el Programa de Estabilidad."],["tooltip-pib-ca","Tasa de crecimiento anual de la predicción de PIB o del Empleo a partir del Programa de Estabilidad."],["tooltip-pib-vrp","Variación relativa (en %) entre el PIB o el Empleo simulado con la política fiscal y el PIB o el Empleo previsto en el Programa de Estabilidad."],["tooltip-ee-ca","Tasa de crecimiento anual de la predicción de PIB o del Empleo a partir del Programa de Estabilidad."],["tooltip-ee-vrp","Variación relativa (en %) entre el PIB o el Empleo simulado con la política fiscal y el PIB o el Empleo previsto en el Programa de Estabilidad."]];document.addEventListener("DOMContentLoaded",(function(){for(const e of tooltipInfo)tooltips(...e)}));const idPib=document.getElementById("pib-chart"),idEmpleo=document.getElementById("empleo-chart"),tablePib=".simulation-pib-data",tableEmpleo=".simulation-empleo-data",legendText=["Miles de M €","Miles"];let simulationView=!1,valueFilter="pib",multipLeFired=!1;const locale=d3.formatDefaultLocale({decimal:",",thousands:".",grouping:[3]}),barChart=(e,t,a,n,l,i)=>{const s=32,c=16,o=16,d=56,r=d3.select(e),p=r.select("svg");let m=0,u=0,b=0,v=270;const g=400;let f;const y={},x=d3.scaleOrdinal().range(["#006D63","#B8DF22"]),k=r.append("div").attr("class","tooltip-simulation-bar-chart").style("opacity",0);p.append("text").attr("class","legend-top").attr("x",10).attr("y",20).text(a);const h=()=>{const e=f.map((e=>({year:e[0],neta:e[1],acumulada:e[2]})));let t=d3.keys(e[0]);t=t.slice(1);const a=d3.scaleBand().rangeRound([10,m]).domain(e.map((({year:e})=>e))).paddingInner(.3),n=d3.scaleBand().domain(t),s=d3.scaleLinear().domain([l,i]);y.count={x0:a,x1:n,y:s}},w=e=>{b=r.node().offsetWidth,v=230,m=b-d-c,u=v-s-o,p.attr("width",b).attr("height",v);const t=`translate(${d},${s})`,a=p.select(".bar-grouped-container");a.attr("transform",t),((e,t)=>{y.count.x0.rangeRound([10,e]),y.count.x1.rangeRound([0,y.count.x0.bandwidth()]),y.count.y.range([t-s,o])})(m,u);const n=r.select(".bar-grouped-container-bis"),l=e.map((e=>({year:e[0],neta:e[1],acumulada:e[2]})));let i=d3.keys(l[0]);i=i.slice(1);const f=n.selectAll(".container-grouped").data(l);f.exit().remove(),f.enter().append("g").attr("class","container-grouped").attr("transform",(({year:e})=>`translate(${y.count.x0(e)},0)`));const h=n.selectAll(".container-grouped").selectAll("rect").data((e=>i.map((t=>({key:t,value:e[t]})))));r.selectAll(".container-grouped").data(l).on("mouseover",(function(e){let t="Miles de M €";"empleo-chart"===r._groups[0][0].id&&(t="Miles"),k.style("opacity",1).html(`\n                  <span class="tooltip-bar-chart-year"><strong>Año:</strong> ${e.year}</span>\n                  <span class="tooltip-bar-chart-dif-neta"><strong class="rect-before">Diferencia neta:</strong> ${e.neta.toLocaleString()} ${t}</span>\n                  <span class="tooltip-bar-chart-dif-acumulada"><strong class="rect-before-fluor">Acumulada:</strong> ${e.acumulada.toLocaleString()} ${t}</span>\n            `).style("left",2*d+"px").style("top",`${s}px`)})).on("mouseout",(function(){k.style("opacity",0)})),h.enter().append("rect").attr("width",y.count.x1.bandwidth()).attr("x",(({key:e})=>y.count.x1(e))).attr("fill",(({key:e})=>x(e))).attr("y",0).transition().duration(g).attr("y",(({value:e})=>e>0?y.count.y(e):y.count.y(0))).attr("height",(({value:e})=>Math.abs(y.count.y(e)-y.count.y(0)))),h.transition().duration(g).attr("y",(({value:e})=>e>0?y.count.y(e):y.count.y(0))).attr("height",(({value:e})=>Math.abs(y.count.y(e)-y.count.y(0)))),h.exit().remove(),(e=>{const t=d3.axisBottom(y.count.x0);e.select(".axis-x").transition().delay(((e,t)=>10*t)).duration(g).ease(d3.easeLinear).attr("transform",`translate(0,${u-s})`).call(t);const a=d3.axisLeft(y.count.y).tickFormat(d3.format("d")).tickPadding(10).ticks(5).tickSizeInner(-m);e.select(".axis-y").transition().delay(((e,t)=>10*t)).duration(g).ease(d3.easeLinear).call(a)})(a)};function E(e){let t=[],a=[],n=[];const l=e.map((e=>e.year));for(let a=0;a<e.length;a++){const n=e[a].simulacion-e[a].prevision;t.push(n)}a.push(t[0]);const i=t[0]+t[1];a.push(i);const s=i+t[2];a.push(s);const c=s+t[3];return a.push(c),n=t.map(((e,n)=>[l[n],t[n],a[n]])),n}function B(e,t,a){for(var n=1,l=a.length;n<l;++n)e[a[n]]=+e[a[n]];return e}window.addEventListener("resize",(()=>{d3.csv(`csv/${t}.csv`,B,((e,t)=>{e||(f=E(t),h(),w(f))}))})),d3.csv(`csv/${t}.csv`,B,((e,t)=>{if(!e){const e=d3.selectAll(n).selectAll("div").remove().exit().data(t).enter().append("div").attr("class","simulation-pib-data-container w-100 turquoise20-bgc fl");e.selectAll("span").data((e=>["simulacion"].map((t=>({key:t,value:e[t]}))))).enter().append("span").attr("class","dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc").transition().duration(g).text((({value:e})=>locale.format(",.0f")(e))),e.selectAll(".simulation-percentage").data((e=>["simulacionpercentage"].map((t=>({key:t,value:e[t].toFixed(2)}))))).enter().append("span").attr("class","simulation-percentage fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc").transition().duration(g).text((({value:e})=>e>=0?`+${e}%`:`${e}%`)),f=E(t),(()=>{const e=p.select(".bar-grouped-container");e.append("g").attr("class","axis axis-x"),e.append("g").attr("class","axis axis-y"),e.append("g").attr("class","bar-grouped-container-bis")})(),h(),w(f)}}))};function checkValues(){let e=[];const t=document.getElementsByTagName("input");let a=0;for(let n=0;n<t.length;n++)if(t[n].checked){a++;let l=t[n].id;e.push(l)}if(3===a){const t=document.getElementsByClassName("container-init");for(let e=0;e<t.length;e++)t[e].style.width=0,setTimeout((()=>{t[e].style.display="none"}),150);const a=e.join("-"),n=`pib/${a}`,l=`empleo/${a}`;if(!1===simulationView){d3.selectAll(".legend-top").remove().exit();const e=[-3e4,3e4],t=[-600,600];barChart(idPib,n,legendText[0],tablePib,e[0],e[1]),barChart(idEmpleo,l,legendText[1],tableEmpleo,t[0],t[1])}}}function getWidth(){const e=document.getElementById("empleo-simulacion").offsetWidth+document.getElementById("pib-chart").offsetWidth,t=document.getElementsByClassName("container-init");for(let a=0;a<t.length;a++)t[a].style.width=`${e}px`}getWidth();const multipleLine=()=>{const e=24,t=24,a=40,n=64;let l=0,i=0;const s=d3.select("#multiline-simulation-empleo"),c=s.select("svg"),o={};let d;const r=s.append("div").attr("class","tooltip-simulation").style("opacity",0);!1===multipLeFired&&c.append("text").attr("class","legend-top").attr("x",0).attr("y",20).text("Miles de M €");const p=d=>{const p=document.getElementById("radio-buttons-first"),m=document.getElementById("radio-buttons-second"),u=document.getElementById("radio-buttons-third").offsetHeight;function b(e){e="string"==typeof e?document.querySelector(e):e;var t=window.getComputedStyle(e),a=parseFloat(t.marginTop)+parseFloat(t.marginBottom);return e.offsetHeight+a}const v=s.node().offsetWidth,g=b(p)+b(m)+u;l=v-n-t,i=g-e-a,c.attr("width",v).attr("height",g);const f=`translate(${n},${e})`,y=c.select(".multiline-simulation-empleo-container");y.attr("transform",f),((e,t)=>{o.count.x.range([0,e]),o.count.y.range([t,0])})(l,i);const x=d3.nest().key((e=>e.filter)).entries(d),k=s.select(".multiline-simulation-empleo-container-dos"),h=d3.line().x((e=>o.count.x(e.year))).y((e=>o.count.y(e.simulacion)));k.selectAll(".line").remove().exit().data(x),x.forEach((e=>{k.append("path").attr("class","line "+e.key).attr("id",e.key).style("stroke","#DADADA").attr("d",h(e.values))})),d3.selectAll(".line").data(x).on("mouseover",(function(e){d3.select(this).attr("class","highlighted");const t=d3.select(this).attr("id").split("-"),a=t[0]+"-"+t[1],n=t[2]+"-"+t[3],l=t[4]+"-"+t[5],i=document.getElementById(a).parentNode,c=document.getElementById(n).parentNode,o=document.getElementById(l).parentNode;document.getElementById(a).checked=!0,document.getElementById(n).checked=!0,document.getElementById(l).checked=!0,i.classList.add("active-checkbox"),c.classList.add("active-checkbox"),o.classList.add("active-checkbox");const d=locale.format(",.0f"),p=s.node().offsetWidth,m=`${d3.event.pageX}`,u=`${d3.event.pageY}`,b=d3.select(".tooltip-simulation").node().getBoundingClientRect().width,v=u-d3.select(".tooltip-simulation").node().getBoundingClientRect().height,g=m-b/2,f=p-b/8;let y=[],x=[];for(let t=0;t<e.values.length;t++){const a=d(e.values[t].simulacion);y.push(a)}for(let t=0;t<e.values.length;t++){const a=e.values[t].simulacionpercentage;let n=Number(a).toFixed(2);n=(n>=0?"+":"")+n,x.push(n)}r.style("opacity",1).html(`<div class="w-20 fl">\n                <span class="f5 dib fw7 h2"></span>\n                <span class="db" style="height: 28px;"></span>\n                <span class="f7 black50-txt bb tr greydark-50-bd db pv2 pr3">2022</span>\n                <span class="f7 black50-txt bb tr greydark-50-bd db pv2 pr3">2023</span>\n                <span class="f7 black50-txt bb tr greydark-50-bd db pv2 pr3">2024</span>\n                <span class="f7 black50-txt bb tr greydark-50-bd db pv2 pr3">2025</span>\n                <span class="f7 black50-txt bb tr greydark-50-bd db pv2 pr3">2026</span>\n              </div>\n              <div class="w-40 fl relative">\n                <span class="bd-dotted"></span>\n                <span class="f5 dib vam rect-before h2">Previsión</span>\n                <div class="w-100 h2">\n                  <span class="f7 dib w-50 fl olivedark-txt fw7">PIB</span>\n                  <span class="f7 dib w-50 fl olivedark-txt fw7">Crecimiento</span>\n                </div>\n                <div class="w-100 olive20-bgc fl">\n                  <span class="dib w-50 fl f7 black-text black-txt pv2 tc">1.169.572</span>\n                  <span class="dib w-50 fl f7 black-text black-txt pv2 tc"></span>\n                </div>\n                <div class="w-100 olive20-bgc fl">\n                  <span class="dib w-50 fl f7 black-text bb bt greydark-50-bd black-txt pv2 tc">1.195.302</span>\n                  <span class="fw8 dib w-50 fl f7 black-text bb bt greydark-50-bd black-txt pv2 tc">+2.2%</span>\n                </div>\n                <div class="w-100 olive20-bgc fl">\n                  <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">1.218.013</span>\n                  <span class="fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">+1.9%</span>\n                </div>\n                <div class="w-100 olive20-bgc fl">\n                  <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">1.239.937</span>\n                  <span class="fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">+1.8%</span>\n                </div>\n                <div class="w-100 olive20-bgc fl">\n                  <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">1.262.256</span>\n                  <span class="fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">+1.8%</span>\n                </div>\n                <div class="w-100 fl">\n                  <span class="dib w-50 fl f7 black-text black50-txt pv2 tc">Millones de €</span>\n                </div>\n              </div>\n              <div class="w-40 fl relative">\n                <span class="f5 dib vam rect-before-fluor h2 pl3">Simulacion</span>\n                <div class="w-100 h2">\n                  <span class="f7 dib w-50 fl olivedark-txt fw7 pl3">PIB</span>\n                  <span class="f7 dib w-50 fl olivedark-txt fw7">Crecimiento</span>\n                </div>\n                <div class="w-100 turquoise20-bgc fl bb greydark-50-bd">\n                  <span class="dib w-50 fl f7 black-text black-txt pv2 tc">1.169.572</span>\n                </div>\n                <div class="simulation-pib-data">\n                  <div class="simulation-pib-data-container w-100 turquoise20-bgc fl">\n                    <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${y[0]}</span>\n                    <span class="simulation-percentage fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${x[0]}%\n                    </span>\n                  </div>\n                  <div class="simulation-pib-data-container w-100 turquoise20-bgc fl">\n                    <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${y[1]}</span>\n                    <span class="simulation-percentage fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${x[1]}%\n                    </span>\n                  </div>\n                  <div class="simulation-pib-data-container w-100 turquoise20-bgc fl">\n                    <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${y[2]}</span></span>\n                    <span class="simulation-percentage fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${x[2]}%\n                    </span>\n                  </div>\n                  <div class="simulation-pib-data-container w-100 turquoise20-bgc fl">\n                    <span class="dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${y[3]}</span></span>\n                    <span class="simulation-percentage fw8 dib w-50 fl f7 black-text bb greydark-50-bd black-txt pv2 tc">${x[3]}%\n                    </span>\n                  </div>\n                </div>\n                <div class="w-100 fl">\n                  <span class="dib w-50 fl f7 black-text black50-txt pv2 tc">Millones de €</span>\n                </div>\n              </div>`).style("left",g>p?`${f}px`:`${g}px`).style("top",v-35+"px ")})).on("mouseout",(function(){d3.select(this).attr("class","line").moveToFront(),d3.select(".prevision").moveToFront(),d3.selectAll(".active-checkbox").attr("class","container-radio w-100 pa2 v-mid");const e=d3.select(this).attr("id").split("-"),t=e[0]+"-"+e[1],a=e[2]+"-"+e[3],n=e[4]+"-"+e[5];document.getElementById(t).checked=!1,document.getElementById(a).checked=!1,document.getElementById(n).checked=!1,r.style("opacity",0)})),d3.selection.prototype.moveToFront=function(){return this.each((function(){this.parentNode.appendChild(this)}))},d3.selection.prototype.moveToBack=function(){return this.each((function(){var e=this.parentNode.firstChild;e&&this.parentNode.insertBefore(this,e)}))},d3.select(".prevision").moveToFront(),(e=>{const t=d3.axisBottom(o.count.x).tickFormat(d3.format("d")).tickPadding(15);e.select(".axis-x").attr("transform",`translate(0,${i})`).transition().duration(300).call(t);const a=d3.axisLeft(o.count.y).tickFormat(locale.format(",.0f")).ticks(5).tickSizeInner(-l);e.select(".axis-y").transition().duration(300).call(a)})(y)};d3.select("#empleo-view").on("click",(function(){d3.csv("csv/simulation-all.csv",((e,t)=>{if(e)console.log(e);else{t=t.filter((e=>String(e.type).match("empleo")));const e=d3.scaleTime().domain(d3.extent(t,(e=>e.year))),a=d3.scaleLinear().domain([d3.min(t,(e=>e.simulacion)),d3.max(t,(e=>e.simulacion))]).nice();o.count={x:e,y:a},d3.select(".legend-top").remove(),c.append("text").attr("class","legend-top").attr("x",0).attr("y",20).text("Miles"),p(t)}}))})),d3.select("#pib-view").on("click",(function(){d3.csv("csv/simulation-all.csv",((e,t)=>{if(e)console.log(e);else{t=t.filter((e=>String(e.type).match("pib")));const e=d3.scaleTime().domain(d3.extent(t,(e=>e.year))),a=d3.scaleLinear().domain([d3.min(t,(e=>e.simulacion)),d3.max(t,(e=>e.simulacion))]).nice();o.count={x:e,y:a},d3.select(".legend-top").remove(),c.append("text").attr("class","legend-top").attr("x",0).attr("y",20).text("Miles de M €"),p(t)}}))})),window.addEventListener("resize",(()=>{d3.csv("csv/simulation-all.csv",((e,t)=>{if(e)console.log(e);else{t=t.filter((e=>String(e.type).match(valueFilter)));const e=d3.scaleTime().domain(d3.extent(t,(e=>e.year))),a=d3.scaleLinear().domain([d3.min(t,(e=>e.simulacion)),d3.max(t,(e=>e.simulacion))]).nice();o.count={x:e,y:a},p(t)}}))})),d3.csv("csv/simulation-all.csv",((e,t)=>{e?console.log(e):(t=t.filter((e=>String(e.type).match("pib"))),d3.selectAll(".highlighted").attr("class",""),d=t,(()=>{const e=c.select(".multiline-simulation-empleo-container");e.append("g").attr("class","axis axis-x"),e.append("g").attr("class","axis axis-y"),e.append("g").attr("class","multiline-simulation-empleo-container-dos")})(),(()=>{const e=d3.scaleTime().domain(d3.extent(d,(e=>e.year))),t=d3.scaleLinear().domain([d3.min(d,(e=>e.simulacion)),d3.max(d,(e=>e.simulacion))]).nice();o.count={x:e,y:t}})(),p(d))})),d3.selectAll(".input-radio").on("change",(function(){let e=[];const t=document.getElementsByTagName("input");let a=0;for(let n=0;n<t.length;n++)if(t[n].checked){a++;let l=t[n].id;e.push(l)}if(3===a&&!0===simulationView){const t=e.join("-");n=t,d3.csv("csv/simulation-all.csv",((e,t)=>{e?console.log(e):(d=t.filter((e=>String(e.type).match(valueFilter))),d3.selectAll(".highlighted").attr("class",""),d3.selectAll(`.${n}`).attr("class","highlighted"),p(d))}))}var n}))};checkValues();